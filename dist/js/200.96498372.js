"use strict";(self["webpackChunkvue_final_project"]=self["webpackChunkvue_final_project"]||[]).push([[200],{2200:function(o,t,e){e.r(t),e.d(t,{default:function(){return io}});var a=e(3396),n=e(7139);const l={class:"text-end mt-3"},s={class:"table mt-4"},i=(0,a._)("thead",null,[(0,a._)("tr",null,[(0,a._)("th",null,"名稱"),(0,a._)("th",{width:"120"},"折扣百分比"),(0,a._)("th",{width:"120"},"到期日"),(0,a._)("th",{width:"100"},"是否啟用"),(0,a._)("th",{width:"200"},"編輯")])],-1),d={class:"text-right"},p={class:"text-right"},u={key:0,class:"text-success"},c={key:1,class:"text-muted"},r={class:"btn-group"},m=["onClick"],h=["onClick"];function b(o,t,e,b,_,C){const g=(0,a.up)("LoadingComponent"),f=(0,a.up)("PaginationComponent"),v=(0,a.up)("CouponModal"),w=(0,a.up)("DelCouponModal");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(g,{active:_.isLoading},null,8,["active"]),(0,a._)("div",l,[(0,a._)("button",{class:"btn btn-primary",type:"button",onClick:t[0]||(t[0]=o=>C.openModal(!0))}," 建立新的優惠券 ")]),(0,a._)("table",s,[i,(0,a._)("tbody",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(_.coupons,(t=>((0,a.wg)(),(0,a.iD)("tr",{key:t.id},[(0,a._)("td",null,(0,n.zw)(t.title),1),(0,a._)("td",d,(0,n.zw)(t.percent)+"%",1),(0,a._)("td",p,(0,n.zw)(o.$filters.date(t.due_date)),1),(0,a._)("td",null,[t.is_enabled?((0,a.wg)(),(0,a.iD)("span",u,"啟用")):((0,a.wg)(),(0,a.iD)("span",c,"未啟用"))]),(0,a._)("td",null,[(0,a._)("div",r,[(0,a._)("button",{class:"btn btn-outline-primary btn-sm",onClick:o=>C.openModal(!1,t)},"編輯",8,m),(0,a._)("button",{class:"btn btn-outline-danger btn-sm",onClick:o=>C.openModal(!1,t,!0)},"刪除",8,h)])])])))),128))])]),(0,a.Wm)(f,{pages:_.pagination,onEmitPages:C.getCoupons},null,8,["pages","onEmitPages"]),(0,a.Wm)(v,{ref:"couponModal",coupon:_.tempCoupon,onUpdateCoupon:C.updateCoupon},null,8,["coupon","onUpdateCoupon"]),(0,a.Wm)(w,{ref:"delCouponModal",coupon:_.tempCoupon,onDeleteCoupon:C.deleteCoupon},null,8,["coupon","onDeleteCoupon"])],64)}var _=e(9242);const C={class:"modal fade",id:"exampleModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},g={class:"modal-dialog modal-xl",role:"document"},f={class:"modal-content border-0"},v=(0,a._)("div",{class:"modal-header bg-dark text-white"},[(0,a._)("h5",{class:"modal-title",id:"exampleModalLabel"},[(0,a._)("span",null,"新增優惠券")]),(0,a._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),w={class:"modal-body"},y={class:"row"},x={class:"col-sm-12"},M={class:"mb-3"},k=(0,a._)("label",{for:"title",class:"form-label"},"標題",-1),D={class:"row gx-2"},$={class:"mb-3 col-md-6"},L=(0,a._)("label",{for:"coupon_percent",class:"form-label"},"折扣百分比",-1),U={class:"mb-3"},z=(0,a._)("label",{for:"due_date",class:"form-label"},"到期日",-1),Z={class:"mb-3"},P=(0,a._)("label",{for:"code",class:"form-label"},"Code",-1),V={class:"mb-3"},j={class:"form-check"},W=(0,a._)("label",{class:"form-check-label",for:"is_enabled"}," 是否啟用 ",-1),N={class:"modal-footer"},E=(0,a._)("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function H(o,t,e,n,l,s){return(0,a.wg)(),(0,a.iD)("div",C,[(0,a._)("div",g,[(0,a._)("div",f,[v,(0,a._)("div",w,[(0,a._)("div",y,[(0,a._)("div",x,[(0,a._)("div",M,[k,(0,a.wy)((0,a._)("input",{type:"text",class:"form-control",id:"title",placeholder:"請輸入標題","onUpdate:modelValue":t[0]||(t[0]=o=>l.tempCoupon.title=o)},null,512),[[_.nr,l.tempCoupon.title]])]),(0,a._)("div",D,[(0,a._)("div",$,[L,(0,a.wy)((0,a._)("input",{type:"number",class:"form-control",id:"coupon_percent",placeholder:"請輸入百分比",min:"1","onUpdate:modelValue":t[1]||(t[1]=o=>l.tempCoupon.percent=o)},null,512),[[_.nr,l.tempCoupon.percent,void 0,{number:!0}]])])]),(0,a._)("div",U,[z,(0,a.wy)((0,a._)("input",{type:"date",class:"form-control",id:"due_date","onUpdate:modelValue":t[2]||(t[2]=o=>l.dueDate=o)},null,512),[[_.nr,l.dueDate,void 0,{lazy:!0}]])]),(0,a._)("div",Z,[P,(0,a.wy)((0,a._)("input",{type:"text",class:"form-control",id:"code",placeholder:"請輸入code","onUpdate:modelValue":t[3]||(t[3]=o=>l.tempCoupon.code=o)},null,512),[[_.nr,l.tempCoupon.code]])]),(0,a._)("div",V,[(0,a._)("div",j,[(0,a.wy)((0,a._)("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":t[4]||(t[4]=o=>l.tempCoupon.is_enabled=o),"true-value":1,"false-value":0,id:"is_enabled"},null,512),[[_.e8,l.tempCoupon.is_enabled]]),W])])])])]),(0,a._)("div",N,[E,(0,a._)("button",{type:"button",class:"btn btn-primary",onClick:t[5]||(t[5]=t=>o.$emit("update-coupon",l.tempCoupon))}," 確認 ")])])])],512)}var O=e(1339),S={props:{coupon:{type:Object,default(){return{}}}},watch:{coupon(){this.tempCoupon=this.coupon,this.dueDate=this.$filters.formatTime(this.coupon.due_date)},dueDate(){this.tempCoupon.due_date=this.$filters.toUnixStamp(this.dueDate)}},data(){return{modal:{},tempCoupon:{},dueDate:""}},mixins:[O.Z]},Y=e(89);const K=(0,Y.Z)(S,[["render",H]]);var T=K;const q={class:"modal fade",id:"exampleModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},A={class:"modal-dialog"},B={class:"modal-content"},F={class:"modal-header bg-danger text-white"},G={class:"modal-title"},I=(0,a._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),J={class:"modal-body"},Q={class:"text-danger"},R={class:"modal-footer"},X=(0,a._)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"取消",-1);function oo(o,t,e,l,s,i){return(0,a.wg)(),(0,a.iD)("div",q,[(0,a._)("div",A,[(0,a._)("div",B,[(0,a._)("div",F,[(0,a._)("h5",G,"刪除 "+(0,n.zw)(s.tempCoupon.title),1),I]),(0,a._)("div",J,[(0,a._)("p",null,[(0,a.Uk)("是否刪除 "),(0,a._)("span",Q,(0,n.zw)(s.tempCoupon.title),1),(0,a.Uk)("(刪除後將無法恢復)")])]),(0,a._)("div",R,[X,(0,a._)("button",{type:"button",class:"btn btn-danger text-white",onClick:t[0]||(t[0]=t=>o.$emit("delete-coupon",s.tempCoupon))},"確認刪除")])])])],512)}var to={props:{coupon:{type:Object,default(){return{}}}},watch:{coupon(){this.tempCoupon=this.coupon}},data(){return{modal:{},tempCoupon:{}}},mixins:[O.Z]};const eo=(0,Y.Z)(to,[["render",oo]]);var ao=eo,no=e(5582),lo={data(){return{coupons:[],tempCoupon:{},pagination:{},isNew:!1,isLoading:!1}},components:{CouponModal:T,DelCouponModal:ao,PaginationComponent:no.Z},methods:{openModal(o,t,e=!1){this.tempCoupon=o?{}:{...t},this.isNew=o;const a=e?this.$refs.delCouponModal:this.$refs.couponModal;a.showModal()},getCoupons(o=1){const t=`https://vue3-course-api.hexschool.io/api/chrisluo-api/admin/coupons?page=${o}`;this.isLoading=!0,this.$http.get(t).then((o=>{this.isLoading=!1,o.data.success&&(console.log(o.data.coupons),this.coupons=o.data.coupons,this.pagination=o.data.pagination)}))},updateCoupon(o){this.tempCoupon=o,console.log("updateCoupon",this.tempCoupon);let t="https://vue3-course-api.hexschool.io/api/chrisluo-api/admin/coupon",e="post";this.isNew||(t=`https://vue3-course-api.hexschool.io/api/chrisluo-api/admin/coupon/${this.tempCoupon.id}`,e="put");const a=this.$refs.couponModal;this.isLoading=!0,this.$http[e](t,{data:this.tempCoupon}).then((o=>{this.isLoading=!1,console.log(o),a.hideModal(),this.getCoupons(),this.$httpPushMessageState(o,"優惠券更新")}))},deleteCoupon(o){const t=this.$refs.delCouponModal,e=`https://vue3-course-api.hexschool.io/api/chrisluo-api/admin/coupon/${o.id}`;this.isLoading=!0,this.$http.delete(e).then((o=>{this.isLoading=!1,o.data.success&&(console.log(o),t.hideModal(),this.getCoupons())}))}},created(){this.getCoupons()}};const so=(0,Y.Z)(lo,[["render",b]]);var io=so}}]);
//# sourceMappingURL=200.96498372.js.map