"use strict";(self["webpackChunkvue_final_project"]=self["webpackChunkvue_final_project"]||[]).push([[450],{9450:function(t,e,l){l.r(e),l.d(e,{default:function(){return yt}});var a=l(3396),d=l(7139),s=l(9242);const r={class:"table mt-4"},i=(0,a._)("thead",null,[(0,a._)("tr",null,[(0,a._)("th",null,"購買時間"),(0,a._)("th",null,"Email"),(0,a._)("th",null,"購買款項"),(0,a._)("th",null,"應付金額"),(0,a._)("th",null,"是否付款"),(0,a._)("th",null,"編輯")])],-1),n={key:0},o={class:"list-unstyled"},u={class:"text-right"},c={class:"form-check form switch"},p=["id","onUpdate:modelValue","onChange"],_=["for"],h={key:0},m={key:1},b={class:"btn-group"},g=["onClick"],w=["onClick"];function O(t,e,l,O,y,f){const v=(0,a.up)("LoadingComponent"),k=(0,a.up)("PaginationComponent"),x=(0,a.up)("OrderModal"),M=(0,a.up)("DelOrderModal");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(v,{active:y.isLoading},null,8,["active"]),(0,a._)("table",r,[i,(0,a._)("tbody",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(y.orders,(e=>((0,a.wg)(),(0,a.iD)("tr",{key:e.id},[(0,a._)("td",null,(0,d.zw)(t.$filters.date(e.create_at)),1),(0,a._)("td",null,[e.user?((0,a.wg)(),(0,a.iD)("span",n,(0,d.zw)(e.user.email),1)):(0,a.kq)("",!0)]),(0,a._)("td",null,[(0,a._)("ul",o,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.products,(t=>((0,a.wg)(),(0,a.iD)("li",{key:t.id},(0,d.zw)(t.title)+" 數量: "+(0,d.zw)(t.qty)+" "+(0,d.zw)(t.unit),1)))),128))])]),(0,a._)("td",u,(0,d.zw)(e.total),1),(0,a._)("td",null,[(0,a._)("div",c,[(0,a.wy)((0,a._)("input",{class:"form-check-input",type:"checkbox",id:`paidSwitch${e.id}`,"onUpdate:modelValue":t=>e.is_paid=t,onChange:t=>f.updatePaid(e)},null,40,p),[[s.e8,e.is_paid]]),(0,a._)("label",{class:"form-check-label",for:`paidSwitch${e.id}`},[e.is_paid?((0,a.wg)(),(0,a.iD)("span",h,"已付款")):((0,a.wg)(),(0,a.iD)("span",m,"未付款"))],8,_)])]),(0,a._)("td",null,[(0,a._)("div",b,[(0,a._)("button",{class:"btn btn-outline-primary btn-sm",onClick:t=>f.openModal(!1,e)},"檢視",8,g),(0,a._)("button",{class:"btn btn-outline-danger btn-sm",onClick:t=>f.openModal(!1,e,!0)},"刪除",8,w)])])])))),128))])]),(0,a.Wm)(k,{pages:y.pagination,onEmitPages:f.getOrders},null,8,["pages","onEmitPages"]),(0,a.Wm)(x,{ref:"orderModal",order:y.tempOrder},null,8,["order"]),(0,a.Wm)(M,{ref:"delOrderModal",order:y.tempOrder,onDeleteOrder:f.deleteOrder},null,8,["order","onDeleteOrder"])],64)}const y={class:"modal fade",id:"productModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},f={class:"modal-dialog modal-xl",role:"document"},v={class:"modal-content border-0"},k=(0,a._)("div",{class:"modal-header bg-dark text-white"},[(0,a._)("h5",{class:"modal-title",id:"exampleModalLabel"},[(0,a._)("span",null,"訂單細節")]),(0,a._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),x={class:"modal-body"},M={class:"row"},D={class:"col-md-4"},z=(0,a._)("h3",null,"用戶資料",-1),$={class:"table"},C={key:0},L=(0,a._)("th",{style:{width:"100px"}},"姓名",-1),P=(0,a._)("th",null,"Email",-1),Z=(0,a._)("th",null,"電話",-1),j=(0,a._)("th",null,"地址",-1),q={class:"col-md-8"},E=(0,a._)("h3",null,"訂單細節",-1),H={class:"table"},U=(0,a._)("th",{style:{width:"100px"}},"訂單編號",-1),W=(0,a._)("th",null,"下單時間",-1),Y=(0,a._)("th",null,"付款時間",-1),K={key:0},S={key:1},N=(0,a._)("th",null,"付款狀態",-1),V={key:0,class:"text-success"},A={key:1,class:"text-muted"},B=(0,a._)("th",null,"總金額",-1),F=(0,a._)("h3",null,"選購商品",-1),G={class:"table"},I=(0,a._)("thead",null,[(0,a._)("tr")],-1),J={class:"text-end"},Q=(0,a._)("div",{class:"modal-footer"},[(0,a._)("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 "),(0,a._)("button",{type:"button",class:"btn btn-primary","data-bs-dismiss":"modal"}," 確認 ")],-1);function R(t,e,l,s,r,i){return(0,a.wg)(),(0,a.iD)("div",y,[(0,a._)("div",f,[(0,a._)("div",v,[k,(0,a._)("div",x,[(0,a._)("div",M,[(0,a._)("div",D,[z,(0,a._)("table",$,[r.tempOrder.user?((0,a.wg)(),(0,a.iD)("tbody",C,[(0,a._)("tr",null,[L,(0,a._)("td",null,(0,d.zw)(r.tempOrder.user.name),1)]),(0,a._)("tr",null,[P,(0,a._)("td",null,(0,d.zw)(r.tempOrder.user.email),1)]),(0,a._)("tr",null,[Z,(0,a._)("td",null,(0,d.zw)(r.tempOrder.user.tel),1)]),(0,a._)("tr",null,[j,(0,a._)("td",null,(0,d.zw)(r.tempOrder.user.address),1)])])):(0,a.kq)("",!0)])]),(0,a._)("div",q,[E,(0,a._)("table",H,[(0,a._)("tbody",null,[(0,a._)("tr",null,[U,(0,a._)("td",null,(0,d.zw)(r.tempOrder.id),1)]),(0,a._)("tr",null,[W,(0,a._)("td",null,(0,d.zw)(t.$filters.date(r.tempOrder.create_at)),1)]),(0,a._)("tr",null,[Y,(0,a._)("td",null,[r.tempOrder.paid_date?((0,a.wg)(),(0,a.iD)("span",K,(0,d.zw)(t.$filters.date(r.tempOrder.paid_date)),1)):((0,a.wg)(),(0,a.iD)("span",S,"時間不正確"))])]),(0,a._)("tr",null,[N,(0,a._)("td",null,[r.tempOrder.is_paid?((0,a.wg)(),(0,a.iD)("strong",V,"已付款")):((0,a.wg)(),(0,a.iD)("span",A,"尚未付款"))])]),(0,a._)("tr",null,[B,(0,a._)("td",null,(0,d.zw)(t.$filters.currency(r.tempOrder.total)),1)])])]),F,(0,a._)("table",G,[I,(0,a._)("tbody",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(r.tempOrder.products,(e=>((0,a.wg)(),(0,a.iD)("tr",{key:e.id},[(0,a._)("th",null,(0,d.zw)(e.product.title),1),(0,a._)("td",null,(0,d.zw)(e.qty)+" / "+(0,d.zw)(e.product.unit),1),(0,a._)("td",J,(0,d.zw)(t.$filters.currency(e.final_total)),1)])))),128))])])])])]),Q])])],512)}var T=l(1339),X={name:"orderModal",props:{order:{type:Object,default(){return{}}}},data(){return{status:{},modal:"",tempOrder:{},isPaid:!1}},mixins:[T.Z],watch:{order(){this.tempOrder=this.order,this.isPaid=this.tempOrder.is_paid}}},tt=l(89);const et=(0,tt.Z)(X,[["render",R]]);var lt=et;const at={class:"modal fade",id:"exampleModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},dt={class:"modal-dialog"},st={class:"modal-content"},rt={class:"modal-header bg-danger text-white"},it={class:"modal-title"},nt=(0,a._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),ot={class:"modal-body"},ut={class:"text-danger"},ct={class:"modal-footer"},pt=(0,a._)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"取消",-1);function _t(t,e,l,s,r,i){return(0,a.wg)(),(0,a.iD)("div",at,[(0,a._)("div",dt,[(0,a._)("div",st,[(0,a._)("div",rt,[(0,a._)("h5",it,"刪除 "+(0,d.zw)(r.tempOrder.id),1),nt]),(0,a._)("div",ot,[(0,a._)("p",null,[(0,a.Uk)("是否刪除 "),(0,a._)("span",ut,(0,d.zw)(r.tempOrder.id),1),(0,a.Uk)("(刪除後將無法恢復)")])]),(0,a._)("div",ct,[pt,(0,a._)("button",{type:"button",class:"btn btn-danger text-white",onClick:e[0]||(e[0]=e=>t.$emit("delete-order",r.tempOrder))},"確認刪除")])])])],512)}var ht={props:{order:{type:Object,default(){return{}}}},watch:{order(){this.tempOrder=this.order}},data(){return{modal:{},tempOrder:{}}},mixins:[T.Z]};const mt=(0,tt.Z)(ht,[["render",_t]]);var bt=mt,gt=l(5582),wt={data(){return{orders:[],pagination:{},tempOrder:{},isLoading:!1,isNew:!1}},components:{OrderModal:lt,DelOrderModal:bt,PaginationComponent:gt.Z},methods:{openModal(t,e,l=!1){console.log("openModal",e),this.tempOrder={...e},this.isNew=t;let a=this.$refs.orderModal;l&&(a=this.$refs.delOrderModal),a.showModal()},getOrders(t=1){const e=`https://vue3-course-api.hexschool.io/api/chrisluo-api/admin/orders?page=${t}`;this.isLoading=!0,this.$http.get(e).then((t=>{this.isLoading=!1,t.data.success&&(console.log(t),this.orders=t.data.orders,this.pagination=t.data.pagination)}))},updatePaid(t){const e=`https://vue3-course-api.hexschool.io/api/chrisluo-api/admin/order/${t.id}`;this.isLoading=!0;const l={is_paid:t.is_paid};this.$http.put(e,{data:l}).then((t=>{this.isLoading=!1,t.data.success&&(console.log(t),this.getOrders(),this.$httpPushMessageState(t,"訂單更新"))}))},deleteOrder(t){const e=this.$refs.delOrderModal,l=`https://vue3-course-api.hexschool.io/api/chrisluo-api/admin/order/${t.id}`;this.isLoading=!0,this.$http.delete(l).then((t=>{this.isLoading=!1,t.data.success&&(console.log(t),e.hideModal(),this.getOrders())}))}},created(){this.getOrders()}};const Ot=(0,tt.Z)(wt,[["render",O]]);var yt=Ot}}]);
//# sourceMappingURL=450.cbc82caa.js.map